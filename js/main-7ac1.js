!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){e.exports=jQuery},function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"a",function(){return r}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return i});const o={renderPrefix:"//api.notelive.cc/render/",queryOne:"//api.notelive.cc/server/queryOne",replaceOrInsertOne:"//api.notelive.cc/server/replaceOrInsertOne"},r={responseCode:{SUCCESS:200,NO_AUTH:505,ERROR:500}};class s{constructor(e){return e&&(this.id=e.id,this.title=e.title,this.queryPassword=e.queryPassword,this.password=e.password,this.content=e.content,this.contentType=e.contentType,this.lockType=e.lockType),this}getTitle(){return this.title}getContent(){return this.content}getQueryPassword(){return this.queryPassword}getPassword(){return this.password}getContentType(){return this.contentType}getLockType(){return this.lockType}setTitle(e){return this.title=e,this}setContent(e){return this.content=e,this}setQueryPassword(e){return this.queryPassword=e,this}setPassword(e){return this.password=e,this}setContentType(e){return this.contentType=e,this}setLockType(e){return this.lockType=e,this}}class i{constructor(e){return e&&(this.code=e.code,this.msg=e.msg,this.data=e.data),this}getCode(){return this.code}getMsg(){return this.msg}getData(){return this.data}getNote(){return new s(this.data)}}},function(e,t){e.exports=_},function(e,t,n){"use strict";n.r(t);n(6);var o=n(2),r=n.n(o),s=n(0),i=n.n(s),c=n(1);let a,u,l,d,f,p,h,y,g,w,T,v,P,C=0;function b(){u.hide(),h.show(),p.focus()}function O(){u.attr("disabled",!0),w.show(),g.focus(),g.val(a.getPassword()),P.val(a.getLockType()||"rw")}function m(){1===C&&l.html("未保存"),C=0}function _(e){l.html("<font style='color:red'>"+e+"</font>"),C=0}function k(){i.a.ajax({type:"POST",url:c.d.queryOne,data:{title:a.getTitle(),queryPassword:a.getQueryPassword()},success:function(e){if(e){let t=new c.c(e);if(t.getCode()===c.a.responseCode.SUCCESS){if(u.show(),h.hide(),t.getData()){let e=a.getQueryPassword();(a=t.getNote()).setQueryPassword(e),l.val(a.getTitle()),u.text(a.getContent()),d.val(a.getContentType())}}else t.getCode()===c.a.responseCode.NO_AUTH?b():(console.error(t),_("读取数据错误,"+t.getMsg()))}},error:function(e){console.error(e),_("读取数据失败,服务器连接失败")}})}function S(){a.setContent(u.val()),function(e){i.a.ajax({type:"POST",url:c.d.replaceOrInsertOne,data:e,success:function(e){if(e){let t=new c.c(e);t.getCode()===c.a.responseCode.SUCCESS?(0===C&&l.html("已保存"),C=1,console.log("update data")):t.getCode()===c.a.responseCode.NO_AUTH?b():(console.error(t),_("保存失败，"+t.getMsg()))}},error:function(e){console.error(e),_("保存失败，服务器连接失败")}})}(a)}i()(function(){u=i()("#content"),l=i()("#tip"),d=i()("#contentType"),f=i()("#api_url"),function(){u.text(""),a=new c.b;let e=location.hash;void 0===e||null==e||""===e?(e=function(e){e=e||32;const t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=t.length;let o="";for(let r=0;r<e;r++)o+=t.charAt(Math.floor(Math.random()*n));return o}(4),a.setTitle(e),console.log("random title:"+e),window.location.href="#"+e):(console.log("load from hash:"+e),function(e){i()("[href$='{anchor}']").attr("href",function(t,n){return n.replace("{anchor}",e)})}(e),(e=decodeURI(e.substr(1))).length>8&&(window.location.href="#"+e.substring(0,8)),document.title=e+" @note live",a.setTitle(e),f.attr("href",c.d.renderPrefix+e),f.text(document.location.protocol+c.d.renderPrefix+e),k())}(),window.onhashchange=(()=>location.reload()),u.on("blur",function(){console.log("on blur to save data"),S()}),u.on("input propertychange",r.a.throttle(function(){S()},5e3,{leading:!0})),u.on("input propertychange",m),d.on("change",()=>{m(),a.setContentType(d.val()),S()}),function(){p=i()("#password"),h=i()("#password_div"),y=i()("#password_btn"),g=i()("#new_password"),w=i()("#new_password_div"),T=i()("#new_password_btn"),v=i()("#new_password_cancel"),P=i()("#lockType");let e=function(){a.setQueryPassword(p.val()),k(),p.val("")};p.on("keypress",function(t){13===t.keyCode&&e()}),y.on("click",e),i()("#modify_password").on("click",O),T.on("click",function(){a.setPassword(g.val()),a.getPassword()?a.setLockType(P.val()):a.setLockType(null),S(),a.setQueryPassword(g.val()),u.removeAttr("disabled"),w.hide()}),v.on("click",function(){u.removeAttr("disabled"),w.hide()})}()})},,,function(e,t){}]);